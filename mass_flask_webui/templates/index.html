{% extends "base.html" %}

{% block page_title %}
Index
{% endblock %}

{% block content %}

    <div class="page-header">
        <h1><i class="fa fa-server"></i> MASS Server
            <small>Version {{ mass_version() }}</small>
        </h1>
    </div>

    <div class="row">
        <div class="col-md-6">
            <h2>Latest samples</h2>
            <table class="table table-striped table-hover">
                <tr><th>#ID</th><th>Delivery date</th></tr>
                {% for sample in latest_samples %}
                    <tr><td>{{ sample_icon(sample) }} <a href="{{ url_for('mass_flask_webui.sample_detail', sample_id=sample.id) }}">{{ sample.title }}</a></td><td>{{ sample.delivery_date }}</td></tr>
                {% endfor %}
            </table>

            <h2>Latest reports</h2>
            <table class="table table-striped table-hover">
                <tr><th>#ID</th><th>Report date</th></tr>
                {% for report in latest_reports %}
                    <tr><td>{{ report }}</td><td>{{ report.report_date }}</td></tr>
                {% endfor %}
            </table>
        </div>

        <div class="col-md-6 panel-group">
            <div>
                <h2>Database statistics</h2>
                <dl class="dl-horizontal">
                    <dt>Total number of samples</dt>
                    <dd>{{ count_sample }}</dd>
                    <dt>File samples</dt>
                    <dd>{{ count_file_sample }}</dd>
                    <dt>Executable binary samples</dt>
                    <dd>{{ count_executable_binary_sample }}</dd>
                    <dt>IP samples</dt>
                    <dd>{{ count_ip_sample }}</dd>
                    <dt>Domain samples</dt>
                    <dd>{{ count_domain_sample }}</dd>
                    <dt>URI samples</dt>
                    <dd>{{ count_uri_sample }}</dd>
                </dl>
            </div>
        </div>
    </div>

{% endblock %}
